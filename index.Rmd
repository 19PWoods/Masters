---
title: "Woods Master's Thesis"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(tidyverse)
library(flexdashboard)
library(readxl)
library(tcltk)
library(ggpubr)
library(plotly)
library(reactable)
theme_set(theme_classic())


setwd("C:/Users/Phil/Dropbox/Thesis- Stretch Activation/Data/Woods - Master's Thesis/Project/Tension + AaBbCc")

### Data -------------------------------------------------------------------------

my_data <- read_excel("SA-Fatigue_Tension+Step+Kinetics_PW_10-28-22.xlsx", 
                      sheet = "Included",
                      skip = 5,
                      na="") %>% 
  filter(Exp_Con_Num %in% c(3,5,6)) %>%
  filter(Ran_Num ==1) %>% 
  filter(fiber_type_num %in% (1:4)) %>%
  group_by(Exp_Con, fiber_type, fiber_type_num) %>%
  summarize(n = n(),
            f0_avg = mean(Po_Pre_Step, na.rm=T),
            f0_sd = sd(Po_Pre_Step, na.rm=T),
            f0_se = sd(Po_Pre_Step, na.rm=T)/sqrt(n()),
            fsa_avg = mean(Fsa, na.rm = T),
            fsa_sd = sd(Fsa, na.rm = T),
            fsa_se = sd(Fsa, na.rm = T)/sqrt(n()),
            fsaf0_avg = mean(FsaF0, na.rm = T),
            fsaf0_sd = sd(FsaF0, na.rm = T),
            fsaf0_se = sd(FsaF0, na.rm = T)/sqrt(n()),
            fsatotal_avg = mean(Fsa_total, na.rm = T),
            fsatotal_sd = sd(Fsa_total, na.rm = T),
            fsatotal_se = sd(Fsa_total, na.rm = T)/sqrt(n())
  )

my_data_filt <- read_excel("SA-Fatigue_Tension+Step+Kinetics_PW_10-28-22.xlsx", 
                      sheet = "Included",
                      skip = 5,
                      na="") %>% 
  filter(Exp_Con_Num %in% c(3,5,6)) %>%
  filter(fiber_type_num %in% (1:4)) %>%
   filter(Ran_Num == 1) %>% 
  filter(P3_num == 1) %>% 
  group_by(Exp_Con, fiber_type, fiber_type_num) %>%
  summarize(n = n(),
            f0_avg = mean(Po_Pre_Step, na.rm=T),
            f0_sd = sd(Po_Pre_Step, na.rm=T),
            f0_se = sd(Po_Pre_Step, na.rm=T)/sqrt(n()),
            fsa_avg = mean(Fsa, na.rm = T),
            fsa_sd = sd(Fsa, na.rm = T),
            fsa_se = sd(Fsa, na.rm = T)/sqrt(n()),
            fsaf0_avg = mean(FsaF0, na.rm = T),
            fsaf0_sd = sd(FsaF0, na.rm = T),
            fsaf0_se = sd(FsaF0, na.rm = T)/sqrt(n()),
            fsatotal_avg = mean(Fsa_total, na.rm = T),
            fsatotal_sd = sd(Fsa_total, na.rm = T),
            fsatotal_se = sd(Fsa_total, na.rm = T)/sqrt(n())
  )

my_data_raw <- read_excel("SA-Fatigue_Tension+Step+Kinetics_PW_10-28-22.xlsx", 
                      sheet = "Included",
                      skip = 5,
                      na="") %>% 
  filter(Ran_Num == 1) %>% 
  filter(Exp_Con_Num %in% c(3,5,6)) %>% 
  filter(fiber_type_num %in% c(1:4)) %>% 
  group_by(Exp_Con, fiber_type)

my_data_rates <- read_excel("SA-Fatigue_Tension+Step+Kinetics_PW_10-28-22.xlsx", 
                      sheet = "Included",
                      skip = 5,
                      na="") %>% 
  filter(Exp_Con_Num %in% c(3,5,6)) %>% 
  filter(fiber_type_num %in% c(1:4)) %>% 
  filter(Ran_Num == 1) %>% 
  filter(P3_num == 1) %>% 
  dplyr::group_by(fiber_type,fiber_type_num, Exp_Con) %>% 
  dplyr::summarize(n = n(),
                   a2_avg = mean(a2, na.rm=T),
                   a2_sd = sd(a2, na.rm = T),
                   a2_se = sd(a2, na.rm = T)/sqrt(n()),
                   r2_avg = mean(r2, na.rm = T),
                   r2_sd = sd(r2, na.rm = T),
                   r2_se = sd(r2, na.rm = T)/sqrt(n()),
                   a3_avg = mean(a3, na.rm=T),
                   a3_sd = sd(a3, na.rm = T),
                   a3_se = sd(a3, na.rm = T)/sqrt(n()),
                   r3_avg = mean(r3, na.rm = T),
                   r3_sd = sd(r3, na.rm = T),
                   r3_se = sd(r3, na.rm = T)/sqrt(n()),
                   a4_avg = mean(a4, na.rm=T),
                   a4_sd = sd(a4, na.rm = T),
                   a4_se = sd(a4, na.rm = T)/sqrt(n()),
                   r4_avg = mean(r4, na.rm = T),
                   r4_sd = sd(r4, na.rm = T),
                   r4_se = sd(r4, na.rm = T)/sqrt(n()),
  )

my_data_rates_csa <- read_excel("SA-Fatigue_Tension+Step+Kinetics_PW_10-28-22.xlsx", 
                      sheet = "Included",
                      skip = 5,
                      na="") %>% 
  filter(Exp_Con_Num %in% c(3,5,6)) %>% 
  filter(fiber_type_num %in% c(1:4)) %>% 
  filter(Ran_Num == 1) %>% 
  filter(P3_num == 1) %>% 
  dplyr::group_by(fiber_type,fiber_type_num, Exp_Con) %>% 
  dplyr::summarize(n = n(),
                   a2.csa_avg = mean(a2.csa, na.rm=T),
                   a2.csa_sd = sd(a2.csa, na.rm = T),
                   a2.csa_se = sd(a2.csa, na.rm = T)/sqrt(n()),
                   r2_avg = mean(r2, na.rm = T),
                   r2_sd = sd(r2, na.rm = T),
                   r2_se = sd(r2, na.rm = T)/sqrt(n()),
                   a3.csa_avg = mean(a3.csa, na.rm=T),
                   a3.csa_sd = sd(a3.csa, na.rm = T),
                   a3.csa_se = sd(a3.csa, na.rm = T)/sqrt(n()),
                   r3_avg = mean(r3, na.rm = T),
                   r3_sd = sd(r3, na.rm = T),
                   r3_se = sd(r3, na.rm = T)/sqrt(n()),
                   a4.csa_avg = mean(a4.csa, na.rm=T),
                   a4.csa_sd = sd(a4.csa, na.rm = T),
                   a4.csa_se = sd(a4.csa, na.rm = T)/sqrt(n()),
                   r4_avg = mean(r4, na.rm = T),
                   r4_sd = sd(r4, na.rm = T),
                   r4_se = sd(r4, na.rm = T)/sqrt(n()),
)

my_data_raw_rates <- read_excel("SA-Fatigue_Tension+Step+Kinetics_PW_10-28-22.xlsx", 
                      sheet = "Included",
                      skip = 5,
                      na="") %>% 
  filter(Exp_Con_Num %in% c(3,5,6)) %>% 
   filter(Ran_Num == 1) %>% 
  filter(P3_num == 1) %>% 
  filter(fiber_type_num %in% c(1:4)) %>% 
  group_by(Exp_Con, fiber_type)

my_data_rates_dbl <- read_excel("SA-Fatigue_Tension+Step+Kinetics_PW_10-28-22.xlsx", 
                      sheet = "Included",
                      skip = 5,
                      na="") %>% 
  filter(Exp_Con_Num %in% c(3,5,6)) %>% 
  filter(fiber_type_num %in% c(1:4)) %>% 
  filter(Ran_Num == 1) %>% 
  filter(P3_num == 0) %>% 
  dplyr::group_by(fiber_type,fiber_type_num, Exp_Con) %>% 
  dplyr::summarize(n = n(),
                   a2_avg = mean(a2, na.rm=T),
                   a2_sd = sd(a2, na.rm = T),
                   a2_se = sd(a2, na.rm = T)/sqrt(n()),
                   r2_avg = mean(r2, na.rm = T),
                   r2_sd = sd(r2, na.rm = T),
                   r2_se = sd(r2, na.rm = T)/sqrt(n()),
                   a4_avg = mean(a4, na.rm=T),
                   a4_sd = sd(a4, na.rm = T),
                   a4_se = sd(a4, na.rm = T)/sqrt(n()),
                   r4_avg = mean(r4, na.rm = T),
                   r4_sd = sd(r4, na.rm = T),
                   r4_se = sd(r4, na.rm = T)/sqrt(n()),
  )

my_data_raw_rates_dbl <- read_excel("SA-Fatigue_Tension+Step+Kinetics_PW_10-28-22.xlsx", 
                      sheet = "Included",
                      skip = 5,
                      na="") %>% 
  filter(Exp_Con_Num %in% c(3,5,6)) %>% 
   filter(Ran_Num == 1) %>% 
  filter(P3_num == 0) %>% 
  filter(fiber_type_num %in% c(1:4)) %>% 
  group_by(Exp_Con, fiber_type)

### Stretch Activation Tab-------------------------------------------------------------
(f0_gg <- my_data %>% 
    ggplot(aes(Exp_Con, 
               f0_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw,
               aes(x = Exp_Con,
                   y = Po_Pre_Step,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=f0_avg-f0_se,
                      ymax=f0_avg+f0_se),
                  position = position_dodge(width = 0.9),
                  width=0.3,
                  size = 2) +
    scale_y_continuous(limits = c(0,350)) +
    ylab("Calcium-activated Specific Tension (mN/mm^2)")+
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Calcium Fatigue",
                                "Low Calcium Fatigue"))
)

(Fsa_gg <- my_data_filt %>% 
    ggplot(aes(Exp_Con, 
               fsa_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = Fsa,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=fsa_avg-fsa_se,
                      ymax=fsa_avg+fsa_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    scale_y_continuous(limits = c(0,75)) +
    ylab("Stretch-activated Specific Tension (mN/mm^2)")+
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Calcium Fatigue",
                                "Low Calcium Fatigue"))
)

(FsaF0_gg <- my_data_filt %>% 
    ggplot(aes(Exp_Con, 
               fsatotal_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = Fsa_total,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=fsatotal_avg-fsatotal_se,
                      ymax=fsatotal_avg+fsatotal_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    scale_y_continuous(limits = c(0,35)) +
    ylab("Stretch-to-Calcium-activated Specific Tension (%)")+
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Calcium Fatigue",
                                "Low Calcium Fatigue"))
)

### 3 Exponential Fits------------------------------------------------------
(a2_gg <- my_data_rates %>% 
    ggplot(aes(Exp_Con, 
               a2_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = a2,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=a2_avg-a2_se,
                      ymax=a2_avg+a2_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("a2") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(a3_gg <- my_data_rates %>% 
    ggplot(aes(Exp_Con, 
               a3_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = a3,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=a3_avg-a3_se,
                      ymax=a3_avg+a3_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("a3") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(a4_gg <- my_data_rates%>% 
    ggplot(aes(Exp_Con, 
               a4_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = a4,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=a4_avg-a4_se,
                      ymax=a4_avg+a4_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("a4") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 10),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)


(a2.csa_gg <- my_data_rates_csa %>% 
    ggplot(aes(Exp_Con, 
               a2.csa_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = a2.csa,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=a2.csa_avg-a2.csa_se,
                      ymax=a2.csa_avg+a2.csa_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("a2 Normalized") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(a3.csa_gg <- my_data_rates_csa %>% 
    ggplot(aes(Exp_Con, 
               a3.csa_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = a3.csa,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=a3.csa_avg-a3.csa_se,
                      ymax=a3.csa_avg+a3.csa_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("a3 Normalized") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(a4.csa_gg <- my_data_rates_csa %>% 
    ggplot(aes(Exp_Con, 
               a4.csa_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = a4.csa,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=a4.csa_avg-a4.csa_se,
                      ymax=a4.csa_avg+a4.csa_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("a4 Normalized") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 10),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(r2_gg <- my_data_rates %>% 
    ggplot(aes(Exp_Con, 
               r2_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = r2,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=r2_avg-r2_se,
                      ymax=r2_avg+r2_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("r2") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(r3_gg <- my_data_rates %>% 
    ggplot(aes(Exp_Con, 
               r3_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = r3,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=r3_avg-r3_se,
                      ymax=r3_avg+r3_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("r3") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(r4_gg <- my_data_rates %>% 
    ggplot(aes(Exp_Con, 
               r4_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates,
               aes(x = Exp_Con,
                   y = r4,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=r4_avg-r4_se,
                      ymax=r4_avg+r4_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("r4") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)


### Double Exponential Fits------------------------------------------------------
(a2_gg_dbl <- my_data_rates_dbl %>% 
    ggplot(aes(Exp_Con, 
               a2_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates_dbl,
               aes(x = Exp_Con,
                   y = a2,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=a2_avg-a2_se,
                      ymax=a2_avg+a2_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("a2") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)


(a4_gg_dbl <- my_data_rates_dbl %>% 
    ggplot(aes(Exp_Con, 
               a4_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates_dbl,
               aes(x = Exp_Con,
                   y = a4,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=a4_avg-a4_se,
                      ymax=a4_avg+a4_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("a4") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 10),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(r2_gg_dbl <- my_data_rates_dbl %>% 
    ggplot(aes(Exp_Con, 
               r2_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates_dbl,
               aes(x = Exp_Con,
                   y = r2,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=r2_avg-r2_se,
                      ymax=r2_avg+r2_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("r2") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

(r4_gg_dbl <- my_data_rates_dbl %>% 
    ggplot(aes(Exp_Con, 
               r4_avg, 
               group = fiber_type_num)) +
    geom_bar(aes(fill = fiber_type),
             stat = "identity",
             position = position_dodge())+
    geom_point(data = my_data_raw_rates_dbl,
               aes(x = Exp_Con,
                   y = r4,
                   text = paste("Filename", Filename)),
               position = position_dodge(width = 0.9)) +
    geom_errorbar(aes(ymin=r4_avg-r4_se,
                      ymax=r4_avg+r4_se),
                  position = position_dodge(width = 0.9),
                  width=0.15,
                  size = 1.25) +
    ylab("r4") +
    guides(fill=guide_legend(title = "Fiber Types")) + 
    theme(axis.title.y = element_text(size = 18),
          axis.title.x = element_blank(),
          axis.text = element_text(size = 15),
          legend.title = element_text(size = 15),
          legend.text = element_text(size = 15),
          legend.key.size = unit(1,"cm")) +
    scale_fill_manual(breaks = c("I",
                                 "IIA",
                                 "IIX",
                                 "IIB"),
                      values = c("#E69F00",
                                 "#56B4E9",
                                 "#CC79A7",
                                 "#009E73")) +
    scale_x_discrete(breaks = c("Active",
                                "Fat_4.5",
                                "Fat_5.1"),
                     labels = c("Active",
                                "High Ca++",
                                "Low Ca++"))
)

```

# Data

## Column {data-width=400, .tabset}

### Raw Data

```{r}
reactable(my_data_raw)

```
### Avereaged Data
```{r}
reactable(my_data_filt)
```

# Stretch Activation

## Column {data-width=500, .tabset}

### F0 - Averaged

```{r}
ggplotly(f0_gg, )

```

### Fsa - Averaged

```{r}
ggplotly(Fsa_gg)
```

### Fsa/F0 - Averaged

```{r}
ggplotly(FsaF0_gg)
```

# Rate Fittings - 3 Exponential 

## Column {data-width=500, .tabset}

### a2 - Averaged

```{r, fig.height=5, fig.width=5}
ggplotly(a2_gg)
```

### a3 - Averaged

```{r}
ggplotly(a3_gg)
```

### a4 - Averaged

```{r}
ggplotly(a4_gg)
```

## Column {data-width=500, .tabset}

### r2

```{r, fig.height=5, fig.width=5}
ggplotly(r2_gg)
```

### r3

```{r}
ggplotly(r3_gg)
```

### r4

```{r}
ggplotly(r4_gg)
```


# Rate Fittings Normalized - 3 Exponential 

## Column {data-width=500, .tabset}

### a2 - Averaged

```{r, fig.height=5, fig.width=5}
ggplotly(a2.csa_gg)
```

### a3 - Averaged

```{r}
ggplotly(a3.csa_gg)
```

### a4 - Averaged

```{r}
ggplotly(a4.csa_gg)
```

## Column {data-width=500, .tabset}

### r2

```{r, fig.height=5, fig.width=5}
ggplotly(r2_gg)
```

### r3

```{r}
ggplotly(r3_gg)
```

### r4

```{r}
ggplotly(r4_gg)
```


# Rate Fittings - 2 Exponential

## Column {data-width=500, .tabset}

### a2

```{r, fig.height=5, fig.width=5}
ggplotly(a2_gg_dbl)
```

### a4

```{r}
ggplotly(a4_gg_dbl)
```

## Column {data-width=500, .tabset}

### r2

```{r, fig.height=5, fig.width=5}
ggplotly(r2_gg_dbl)
```

### r4

```{r}
ggplotly(r4_gg_dbl)
```
